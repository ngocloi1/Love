var canvas,stage,container,captureContainers,captureIndex;function init(){canvas=document.getElementById("testCanvas"),stage=new createjs.Stage(canvas),canvas.width=window.innerWidth,canvas.height=window.innerHeight;var a=canvas.width,e=canvas.height;container=new createjs.Container,stage.addChild(container),captureContainers=[],captureIndex=0;for(var t=0;t<100;t++){var r=new createjs.Shape;r.graphics.beginFill(createjs.Graphics.getHSL(30*Math.random()-45,100,50+30*Math.random())),r.graphics.moveTo(0,-12).curveTo(1,-20,8,-20).curveTo(16,-20,16,-10).curveTo(16,0,0,12),r.graphics.curveTo(-16,0,-16,-10).curveTo(-16,-20,-8,-20).curveTo(-1,-20,0,-12),r.y=-100,container.addChild(r)}var n=new createjs.Text("the longer I'm with you\nthe more I love you","bold 24px Arial","#312");for(n.textAlign="center",n.x=a/2,n.y=e/2-n.getMeasuredLineHeight(),stage.addChild(n),t=0;t<100;t++){var o=new createjs.Container;o.cache(0,0,a,e),captureContainers.push(o)}createjs.Ticker.timingMode=createjs.Ticker.RAF,createjs.Ticker.on("tick",tick)}function tick(a){var e=canvas.width,t=canvas.height,r=container.numChildren;captureIndex=(captureIndex+1)%captureContainers.length,stage.removeChildAt(0);var n=captureContainers[captureIndex];stage.addChildAt(n,0),n.addChild(container);for(var o=0;o<r;o++){var i=container.getChildAt(o);i.y<-50&&(i._x=Math.random()*e,i.y=t*(1+Math.random())+50,i.perX=(1+2*Math.random())*t,i.offX=Math.random()*t,i.ampX=.1*i.perX*(.15+Math.random()),i.velY=2*-Math.random()-1,i.scale=2*Math.random()+1,i._rotation=40*Math.random()-20,i.alpha=.75*Math.random()+.05,i.compositeOperation=Math.random()<.33?"lighter":"source-over");var c=(i.offX+i.y)/i.perX*Math.PI*2;i.y+=i.velY*i.scaleX/2,i.x=i._x+Math.cos(c)*i.ampX,i.rotation=i._rotation+30*Math.sin(c)}n.updateCache("source-over"),stage.update(a)}init();